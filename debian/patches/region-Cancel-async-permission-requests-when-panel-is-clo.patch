From: Robert Ancell <robert.ancell@canonical.com>
Date: Mon, 10 Sep 2018 00:16:10 +0000
Subject: region: Cancel async permission requests when panel is closed

(cherry picked from commit 37d02369b77a57b750b74a8fa2c59ff401f31b98)

Origin: upstream, 3.30.1
---
 panels/region/cc-region-panel.c | 10 +++++-----
 1 file changed, 5 insertions(+), 5 deletions(-)

diff --git a/panels/region/cc-region-panel.c b/panels/region/cc-region-panel.c
index 0023e3a..b20106d 100644
--- a/panels/region/cc-region-panel.c
+++ b/panels/region/cc-region-panel.c
@@ -524,7 +524,7 @@ activate_language_row (CcRegionPanel *self,
                 } else if (g_permission_get_can_acquire (self->permission)) {
                         self->op = CHOOSE_LANGUAGE;
                         g_permission_acquire_async (self->permission,
-                                                    NULL,
+                                                    self->cancellable,
                                                     permission_acquired,
                                                     self);
                 }
@@ -534,7 +534,7 @@ activate_language_row (CcRegionPanel *self,
                 } else if (g_permission_get_can_acquire (self->permission)) {
                         self->op = CHOOSE_REGION;
                         g_permission_acquire_async (self->permission,
-                                                    NULL,
+                                                    self->cancellable,
                                                     permission_acquired,
                                                     self);
                 }
@@ -1069,7 +1069,7 @@ add_input (CcRegionPanel *self)
         } else if (g_permission_get_can_acquire (self->permission)) {
                 self->op = ADD_INPUT;
                 g_permission_acquire_async (self->permission,
-                                            NULL,
+                                            self->cancellable,
                                             permission_acquired,
                                             self);
         }
@@ -1130,7 +1130,7 @@ remove_selected_input (CcRegionPanel *self)
         } else if (g_permission_get_can_acquire (self->permission)) {
                 self->op = REMOVE_INPUT;
                 g_permission_acquire_async (self->permission,
-                                            NULL,
+                                            self->cancellable,
                                             permission_acquired,
                                             self);
         }
@@ -1180,7 +1180,7 @@ move_selected_input (CcRegionPanel *self,
         } else if (g_permission_get_can_acquire (self->permission)) {
                 self->op = op;
                 g_permission_acquire_async (self->permission,
-                                            NULL,
+                                            self->cancellable,
                                             permission_acquired,
                                             self);
         }
