From 7929a519af5119e6c78b93107cb5de9405f7d01f Mon Sep 17 00:00:00 2001
From: Rodrigo Moya <rodrigo@gnome-db.org>
Date: Tue, 27 Sep 2011 16:08:37 +0200
Subject: [PATCH] power: Use the correct item in the combo boxes when
 sleep-when-inactive is disabled

---
 panels/power/cc-power-panel.c |    8 ++++++++
 1 files changed, 8 insertions(+), 0 deletions(-)

diff --git a/panels/power/cc-power-panel.c b/panels/power/cc-power-panel.c
index c069187..92b2e85 100644
--- a/panels/power/cc-power-panel.c
+++ b/panels/power/cc-power-panel.c
@@ -602,6 +602,10 @@ cc_power_panel_init (CcPowerPanel *self)
 
   /* auto-sleep time */
   value = g_settings_get_int (self->priv->gsd_settings, "sleep-inactive-ac-timeout");
+  if (!g_settings_get_boolean (self->priv->gsd_settings, "sleep-inactive-ac"))
+    {
+      value = 0;
+    }
   widget = GTK_WIDGET (gtk_builder_get_object (self->priv->builder,
                                                "combobox_sleep_ac"));
   set_value_for_combo (GTK_COMBO_BOX (widget), value);
@@ -610,6 +614,10 @@ cc_power_panel_init (CcPowerPanel *self)
                     G_CALLBACK (combo_time_changed_cb),
                     self);
   value = g_settings_get_int (self->priv->gsd_settings, "sleep-inactive-battery-timeout");
+  if (!g_settings_get_boolean (self->priv->gsd_settings, "sleep-inactive-battery"))
+    {
+      value = 0;
+    }
   widget = GTK_WIDGET (gtk_builder_get_object (self->priv->builder,
                                                "combobox_sleep_battery"));
   set_value_for_combo (GTK_COMBO_BOX (widget), value);

diff --git a/panels/screen/cc-screen-panel.c b/panels/screen/cc-screen-panel.c
index 4bf5bfa..339cb29 100644
--- a/panels/screen/cc-screen-panel.c
+++ b/panels/screen/cc-screen-panel.c
@@ -312,7 +312,7 @@ set_idle_delay_from_dpms (CcScreenPanel *self,
 {
   guint off_delay;
 
-  off_delay = 1;
+  off_delay = 0;
 
   if (value > 0)
     off_delay = (guint) value;
-- 
1.7.5.4

