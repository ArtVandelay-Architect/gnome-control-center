#
# Ubuntu: https://bugs.launchpad.net/bugs/224229
# Upstream: http://bugzilla.gnome.org/show_bug.cgi?id=545120
# Patch: http://bugzilla.gnome.org/attachment.cgi?id=130847&action=view
# Description: Make Display capplet fit in smaller screens
#
Index: gnome-control-center-2.29.4/capplets/display/display-capplet.ui
===================================================================
--- gnome-control-center-2.29.4.orig/capplets/display/display-capplet.ui	2010-01-11 02:11:17.000000000 +0000
+++ gnome-control-center-2.29.4/capplets/display/display-capplet.ui	2010-01-11 02:12:19.000000000 +0000
@@ -104,28 +104,11 @@
             <child>
               <object class="GtkTable" id="table1">
                 <property name="visible">True</property>
-                <property name="n_rows">3</property>
+                <property name="n_rows">2</property>
                 <property name="n_columns">5</property>
                 <property name="column_spacing">12</property>
                 <property name="row_spacing">6</property>
                 <child>
-                  <object class="GtkCheckButton" id="panel_checkbox">
-                    <property name="label" translatable="yes">Include _panel</property>
-                    <property name="can_focus">True</property>
-                    <property name="receives_default">False</property>
-                    <property name="use_underline">True</property>
-                    <property name="draw_indicator">True</property>
-                  </object>
-                  <packing>
-                    <property name="left_attach">3</property>
-                    <property name="right_attach">5</property>
-                    <property name="top_attach">1</property>
-                    <property name="bottom_attach">2</property>
-                    <property name="x_options">GTK_SHRINK | GTK_FILL</property>
-                    <property name="y_options"></property>
-                  </packing>
-                </child>
-                <child>
                   <object class="GtkLabel" id="label2">
                     <property name="visible">True</property>
                     <property name="xalign">0</property>
@@ -151,10 +134,10 @@
                     <property name="mnemonic_widget">refresh_combo</property>
                   </object>
                   <packing>
-                    <property name="left_attach">1</property>
-                    <property name="right_attach">2</property>
-                    <property name="top_attach">2</property>
-                    <property name="bottom_attach">3</property>
+                    <property name="left_attach">3</property>
+                    <property name="right_attach">4</property>
+                    <property name="top_attach">0</property>
+                    <property name="bottom_attach">1</property>
                     <property name="x_options">GTK_SHRINK | GTK_FILL</property>
                     <property name="y_options"></property>
                   </packing>
@@ -170,8 +153,8 @@
                   <packing>
                     <property name="left_attach">3</property>
                     <property name="right_attach">4</property>
-                    <property name="top_attach">2</property>
-                    <property name="bottom_attach">3</property>
+                    <property name="top_attach">1</property>
+                    <property name="bottom_attach">2</property>
                     <property name="x_options">GTK_SHRINK | GTK_FILL</property>
                     <property name="y_options"></property>
                   </packing>
@@ -194,10 +177,10 @@
                     <property name="visible">True</property>
                   </object>
                   <packing>
-                    <property name="left_attach">2</property>
-                    <property name="right_attach">3</property>
-                    <property name="top_attach">2</property>
-                    <property name="bottom_attach">3</property>
+                    <property name="left_attach">4</property>
+                    <property name="right_attach">5</property>
+                    <property name="top_attach">0</property>
+                    <property name="bottom_attach">1</property>
                     <property name="y_options"></property>
                   </packing>
                 </child>
@@ -215,8 +198,8 @@
                   <packing>
                     <property name="left_attach">4</property>
                     <property name="right_attach">5</property>
-                    <property name="top_attach">2</property>
-                    <property name="bottom_attach">3</property>
+                    <property name="top_attach">1</property>
+                    <property name="bottom_attach">2</property>
                     <property name="y_options"></property>
                   </packing>
                 </child>
@@ -229,7 +212,7 @@
                     </child>
                   </object>
                   <packing>
-                    <property name="bottom_attach">3</property>
+                    <property name="bottom_attach">2</property>
                     <property name="y_options">GTK_FILL</property>
                   </packing>
                 </child>
Index: gnome-control-center-2.29.4/capplets/display/xrandr-capplet.c
===================================================================
--- gnome-control-center-2.29.4.orig/capplets/display/xrandr-capplet.c	2010-01-11 02:11:21.000000000 +0000
+++ gnome-control-center-2.29.4/capplets/display/xrandr-capplet.c	2010-01-11 02:12:19.000000000 +0000
@@ -55,7 +55,6 @@
     GtkWidget	   *resolution_combo;
     GtkWidget	   *refresh_combo;
     GtkWidget	   *rotation_combo;
-    GtkWidget	   *panel_checkbox;
     GtkWidget	   *clone_checkbox;
     GtkWidget	   *show_icon_checkbox;
 
@@ -766,7 +765,6 @@
 #if 0
     g_debug ("sensitive: %d, on: %d", sensitive, app->current_output->on);
 #endif
-    gtk_widget_set_sensitive (app->panel_checkbox, sensitive);
 
     app->ignore_gui_changes = FALSE;
 }
@@ -1144,8 +1142,8 @@
    }
 }
 
-#define SPACE 15
-#define MARGIN  15
+#define SPACE 5
+#define MARGIN 5
 
 static GList *
 list_connected_outputs (App *app, int *total_w, int *total_h)
@@ -2525,21 +2523,17 @@
 
     g_signal_connect (app->show_icon_checkbox, "toggled", G_CALLBACK (on_show_icon_toggled), app);
 
-    app->panel_checkbox = _gtk_builder_get_widget (builder, "panel_checkbox");
-
     make_text_combo (app->resolution_combo, 4);
     make_text_combo (app->refresh_combo, 3);
     make_text_combo (app->rotation_combo, -1);
 
-    g_assert (app->panel_checkbox);
-
     /* Scroll Area */
     app->area = (GtkWidget *)foo_scroll_area_new ();
 
     g_object_set_data (G_OBJECT (app->area), "app", app);
 
     /* FIXME: this should be computed dynamically */
-    foo_scroll_area_set_min_size (FOO_SCROLL_AREA (app->area), -1, 200);
+    foo_scroll_area_set_min_size (FOO_SCROLL_AREA (app->area), -1, 150);
     gtk_widget_show (app->area);
     g_signal_connect (app->area, "paint",
 		      G_CALLBACK (on_area_paint), app);
